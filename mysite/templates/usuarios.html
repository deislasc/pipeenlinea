{%- extends "base.html" -%}
{%- block content -%}
            <div class="panel">
                {%- if viewName=="Usuarios" -%}
                <div class="botonera">
                    <table border="0px" spacing=0 width="100%" cellpadding="0" cellspacing="0">
                      
                        <tr> 
                        <td width="40%" align="center">Criterio</td>  
                        <td ></td>
                        <td width="40%" align="center">Valor</td>
                        </tr>
                        <tr>
                            <td width="33%" align="center">
                                <select class="roundInput" id="filtroCriterio" name="filtroCriterio" onchange="limpiarFiltroSolicitudes();">
                                    {%- for campo in listaCamposFiltro|sort(attribute='label') -%}
                                        {%- if (campo.filterOption=="true" and campo.editRenderable=="true")-%}
                                            <option value="{{campo.value}}">{{campo.label}}</option>
                                        {%-endif-%}    
                                    {%- endfor -%}
                                </select>
                            </td>  
                            <td></td>
                            <td width="33%" align="center">
                                <input class="roundInput" id="filtroValor" name="filtroValor" onchange="filtrarSolicitudes(usuarios,'filtroCriterio',this.value);"></input>
                            </td>
                        </tr>
                      
                        <tr>  
                            <td colspan="3" align="center">
                               
                                <div class="addButton" id="addUsuarioButton" name="addUsuarioButton" onclick="agregarSolicitud(this);" collapsed="true">
                                </div>
                               
                            </td>  
                        </tr>
                    </table>
                </div>
                {%- endif -%}

               
                <!--********************************************************-->
                
                <div class="listadoItems" id="listadoUsuarios" name="listadoUsuarios">
                    {% include 'addUsuarios.html' %}
                    {# %- for usuario in listaUsuarios|sort(attribute='userName') -% #}
                    {%- for usuario in listaUsuarios -%}
                        <form id="formaSolicitud_{{usuario.ownerID}}">
                            <div class="solicitudItem" id={{usuario.ownerID}} onclick="expandirSolicitud(this);" collapsed="true">
                                <table border="0px" spacing=0 height="100%" width="100%" cellpadding="0" cellspacing="0">
                                    <tr>
                                        <td class="lightLabel" 
                                            colspan="4"
                                            align="center"> 
                                        </td> 
                                    </tr>  
                                    <tr>  
                                        <td class="boldLabel" 
                                            colspan="4"
                                            align="center">
                                            &nbsp{{usuario.userName}}
                                            <br/>
                                            <label class="lightLabel">{{usuario.puesto}}</label>

                                        </td>  
                                       
                                    </tr>
                                    <tr>
                                        <td class="lightLabel" 
                                            colspan="4"
                                            align="center">
                                             <label class="lightLabel">{{usuario.userEstatus}}</label>
                                        </td> 
                                    </tr>       
                                </table>
                            </div> <!-- FINALIZA <div class="solicitudItem"> -->
                            


                            <!--********************************************************-->
                            <div class="detalleSolicitudItem" id="detalleSolicitud_{{usuario.ownerID}}">    
                                <table id="tablaDetalleSolicitud_{{usuario.ownerID}}" border="0px" spacing=0 width="100%" cellpadding="0" cellspacing="0">
                                    {# listaCamposFiltro|pprint #}
                                    {%- for campo in listaCamposFiltro -%}
                                        {%-set campoActual=campo.value-%}
                                        {%-set asesorSolicitud=usuario.asesorNombre-%}
                                        {%-set empresaSolicitud=usuario.clienteEmpresa-%}
                                        {%- if campo.editRenderable=="true" -%}
                                            <tr>
                                                {%- if campo.tipo=="textarea" -%}
                                                    <td colspan="3" class="boldSmallLabel">
                                                       {{campo.label}} 
                                                    </td></tr><tr>
                                                {%-else-%}
                                                    <td class="boldSmallLabel" align="right">
                                                    {{campo.label}}
                                                {%-endif-%}   
                                             
                                                {%- if campo.addToogle == 'false' -%}

                                                    {%- if campo.tipo!="textarea" -%} 
                                                        <td colspan="2" style="padding-right:16px; ">
                                                    {%- else -%} 
                                                        <td colspan="3"> 
                                                    {%-endif-%}   
                                                
                                                        <{{campo.tipo}} id="{{campo.value}}_{{usuario.ownerID}}"  name="{{campo.value}}" class="{{campo.class}}"  
                                                        {%- if campoActual == "listaArchivos"-%}
                                                            size="{{campo.size}}"
                                                        {%- endif -%}   

                                                        {%- if campo.tipo == "input" -%}
                                                            value="{{usuario[campoActual]}}"
                                                        {%- endif -%}

                                                        {%- if campo.tipo!="textarea" -%} 
                                                            style="width:100%;"
                                                        {%- endif -%}

                                                        {%- if campoActual in user.forbidden-%}
                                                            disabled="true" 
                                                        {%- endif-%}
                                                        
                                                        
                                                        {# {%- if campoActual=="asesorNombre"-%} onchange="listaEmpresasUpdate(this,{{usuario.ownerID}});"{%-endif-%} #}

                                                        {%- if campoActual=="listaArchivos"-%}
                                                              onchange="mostrarArchivo(this,{{usuario.ownerID}});"
                                                        {%- else -%}
                                                              onchange="updateData(this,{{usuario.ownerID}});"
                                                        {%- endif -%}

                                                        {%-if campo.readOnly=="true"-%}
                                                             readonly
                                                        {%- endif -%}

                                                        >
                                                            
                                                            {%- if campo.tipo=="select"-%}
                                                                 {%- if campoActual=="asesorNombre"-%}
                                                                    {%-for asignacion in listaEmpresas|sort(attribute='asesor') -%}
                                                                        
                                                                            <option value="{{asignacion.asesor}}" 
                                                                                {%-if asignacion.asesor==asesorSolicitud-%} 
                                                                                   selected="selected"
                                                                                {%-endif-%} 
                                                                            >{{asignacion.asesor}}</option>
                                                                
                                                                    {%-endfor-%} 
                                                                {%- elif campoActual=="clienteEmpresa" -%}
                                                                    {%- for asignacion in listaEmpresas -%} 
                                                                       {%- if asignacion.asesor==asesorSolicitud -%}
                                                                            {%- for empresa in asignacion.empresas|sort() -%}
                                                                                <option value="{{empresa}}" 
                                                                                    {%-if empresa==empresaSolicitud-%}
                                                                                        selected="selected"
                                                                                    {%-endif-%}
                                                                                >{{empresa}}
                                                                                </option>  
                                                                            {%- endfor-%}

                                                                       {%-endif-%}
                                                                    {%-endfor-%}
                                                                {%- elif (campoActual=="listaArchivos") -%}
                                                
                                                                    <!-- en lista archivos -->
                                                                    {%- for documento in usuario.documentosLista -%}
                                                                        <option value="{{documento}}">
                                                                            {{documento}}
                                                                        </option>
                                                                    {%- endfor -%}

                                                                {%-else-%}
                                                                    {# PARA TODOS LOS DEMAS CAMPOS QUE TRAEN SU optionsList #}

                                                                    {%- for option in campo.optionsList-%}
                                                                        <option value="{{option}}"
                                                                            {%-if option == usuario[campo.value]-%}
                                                                             selected 
                                                                            {%- endif-%}
                                                                        >{{option}}</option>
                                                                    {%- endfor -%}
                                                                {%-endif-%} {# Finaliza if de campoActual #}

                                                            {%- endif-%} {# Finaliza if "select" #}

                                                        </{{campo.tipo}}>
                                                    </td>
                                                {%- elif campo.addToogle == 'true' -%}
                                                    <td>
                                                        <{{campo.tipo}} id="{{campo.value}}_{{usuario.ownerID}}" name="{{campo.value}}" class="{{campo.class}}" readonly value="{{usuario[campoActual]}}"
                                                        ></{{campo.tipo}}>
                                                    </td>
                                                    <td align="right" style="padding-right: 6px; width: 54px;">
                                                        <label class="switch" {%- if campo.value in user.forbidden -%}
                                                                style="display:none;"
                                                        {%-endif-%}>
                                                            <input type="checkbox" id="check_{{campo.value}}_{{usuario.ownerID}}" name="check_{{campo.value}}_{{usuario.ownerID}}"
                                                            onchange="updateDate({{usuario.ownerID}},{{campo.value}}_{{usuario.ownerID}},this);"
                                                            {%-if (usuario[campoActual]!="") and (usuario[campoActual] is defined)-%}
                                                                checked
                                                            {%-endif-%}
                                                            > 
                                                            <span class="slider round"></span> 
                                                        </label>
                                                    </td>
                                                {%- endif -%}
                                            </tr>
                                        {%- endif -%}
                                   {%- endfor -%}
                                  {#  <tr>
                                       <td colspan=3 valign="middle" align="center">
                                           <input type="submit" value="Guardar Cambios">
                                       </td>
                                   </tr> #}

                                    
                                       
                                    <tr>
                                        <td class="boldSmallLabel" align="right">Nueva Contraseña</td>
                                        <td><input type="text" name="newPassword" id="newPassword_{{usuario.ownerID}}" class="roundInput" placeholder="Ingresa Nueva Contraseña" onchange="updateData(this,{{usuario.ownerID}})"></td>
                                    </tr>
                                       
                                   


                                </table>{# FINALIZA <table border="0" id="tablaDetalleSolicitud"> #} 

                            </div> <!-- FINALIZA <div class="detalleSolicitudItem"> -->

                                <!--********************************************************-->
                            
                        </form>
                            

                    {%- endfor -%}
                    {# <div class="solicitudItem" id="espacioFinal"></div> #}
                </div>        
            </div>  <!--Finaliza panel de Solicitudes-->

    
{%- endblock -%}




 